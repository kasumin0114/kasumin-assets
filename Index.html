<!DOCTYPE html>

<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Kasumin Order</title>
<link href="https://fonts.googleapis.com/css2?family=DotGothic16&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{background:#0d0b1a;display:flex;justify-content:center;align-items:center;min-height:100vh;font-family:'DotGothic16',monospace;padding:8px;}
.game-wrap{position:relative;width:100%;max-width:420px;height:min(680px,100svh);overflow:hidden;border:2px solid rgba(255,255,255,0.2);box-shadow:0 0 40px rgba(180,120,255,0.3);}
.bg{position:absolute;inset:0;background:url('https://raw.githubusercontent.com/kasumin0114/kasumin-assets/main/atelier.png') center/cover no-repeat;}
.bg-overlay{position:absolute;inset:0;background:linear-gradient(to bottom,rgba(10,8,25,0.65) 0%,rgba(10,8,25,0.3) 40%,rgba(10,8,25,0.45) 100%);}
.screen{position:absolute;inset:0;display:none;flex-direction:column;padding:16px;overflow-y:auto;}
.screen.show{display:flex;animation:fi 0.25s ease;}
@keyframes fi{from{opacity:0;transform:translateY(8px);}to{opacity:1;transform:translateY(0);}}
.scr-title{font-size:clamp(14px,3.5vw,17px);color:#e0c0ff;text-align:center;margin-bottom:8px;letter-spacing:0.12em;line-height:1.5;}
.scr-sub{font-size:clamp(10px,2.5vw,12px);color:#aa88bb;text-align:center;margin-bottom:18px;line-height:1.6;}
.lang-grid{display:grid;grid-template-columns:1fr;gap:12px;margin-bottom:20px;max-width:300px;margin-left:auto;margin-right:auto;}
.lang-btn{background:rgba(255,255,255,0.1);border:2px solid rgba(200,160,255,0.4);border-radius:10px;padding:20px;cursor:pointer;text-align:center;transition:all 0.2s;}
.lang-btn:hover{border-color:rgba(255,150,200,0.7);background:rgba(255,180,220,0.2);transform:scale(1.02);}
.lang-flag{font-size:40px;display:block;margin-bottom:8px;}
.lang-name{font-size:16px;color:#fff;font-weight:700;}
.num-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:20px;}
.num-btn{background:rgba(255,255,255,0.08);border:2px solid rgba(200,160,255,0.3);border-radius:10px;padding:18px 12px;cursor:pointer;text-align:center;transition:all 0.2s;}
.num-btn:hover{border-color:rgba(255,150,200,0.6);background:rgba(255,180,220,0.15);}
.num-btn.on{border-color:#ff9ec8;background:rgba(255,130,190,0.25);box-shadow:0 0 12px rgba(255,150,200,0.4);}
.num-emoji{font-size:32px;display:block;margin-bottom:6px;}
.num-label{font-size:clamp(12px,3vw,14px);color:#fff;font-weight:700;display:block;margin-bottom:4px;}
.num-price{font-size:clamp(10px,2.5vw,12px);color:#ffaacc;}
.name-list{margin-bottom:14px;}
.name-item{margin-bottom:12px;}
.name-label{font-size:11px;color:#e0c0ff;margin-bottom:5px;display:block;}
.name-input{width:100%;border:2px solid rgba(200,160,255,0.35);border-radius:6px;padding:9px 12px;font-family:'DotGothic16',monospace;font-size:13px;color:#fff;background:rgba(255,255,255,0.06);}
.name-input:focus{outline:none;border-color:#ff9ec8;background:rgba(255,255,255,0.1);}
.name-input::placeholder{color:#888;}
.checkbox-big{margin-top:10px;padding:14px;background:rgba(255,150,200,0.15);border:2px solid rgba(255,150,200,0.5);border-radius:8px;display:flex;align-items:center;gap:12px;cursor:pointer;user-select:none;}
.checkbox-big input[type="checkbox"]{width:22px;height:22px;cursor:pointer;flex-shrink:0;}
.checkbox-big label{font-size:14px;color:#ffddee;cursor:pointer;font-weight:700;flex:1;line-height:1.4;}
.next-btn{width:100%;padding:12px;background:linear-gradient(135deg,#9060d0,#d060a0);border:none;border-radius:8px;color:white;font-family:'DotGothic16',monospace;font-size:clamp(12px,3vw,14px);font-weight:700;cursor:pointer;letter-spacing:0.1em;box-shadow:0 4px 12px rgba(192,96,160,0.5);transition:all 0.2s;}
.next-btn:hover{transform:translateY(-2px);box-shadow:0 6px 16px rgba(192,96,160,0.6);}
.next-btn:disabled{opacity:0.5;cursor:not-allowed;transform:none;}
#main{position:absolute;inset:0;display:none;flex-direction:column;}
#main.show{display:flex;}
.char-area{display:flex;align-items:flex-end;padding:6px 12px 0;height:26%;position:relative;flex-shrink:0;}
.kasumin-img{height:100%;width:auto;max-width:32%;object-fit:contain;object-position:bottom;filter:drop-shadow(3px 4px 8px rgba(0,0,0,0.6));flex-shrink:0;margin-bottom:-2px;}
.dialog{flex:1;background:rgba(8,6,20,0.9);border:2px solid rgba(200,160,255,0.6);border-radius:6px;padding:7px 11px;margin-left:8px;margin-bottom:6px;position:relative;}
.dialog::before{content:'';position:absolute;left:-10px;top:50%;transform:translateY(-50%);border:5px solid transparent;border-right-color:rgba(200,160,255,0.6);}
.dialog-name{font-size:10px;color:#e0c0ff;margin-bottom:3px;letter-spacing:0.1em;}
.dialog-text{font-size:clamp(10px,2.5vw,12px);color:#fff;line-height:1.45;letter-spacing:0.03em;}
.blink{display:inline-block;animation:bk 1s step-end infinite;color:#e0c0ff;}
@keyframes bk{0%,100%{opacity:1;}50%{opacity:0;}}
.choice-wrap{margin-top:6px;}
.choice-btn{display:block;background:transparent;border:none;color:#fff;font-family:'DotGothic16',monospace;font-size:clamp(10px,2.5vw,12px);cursor:pointer;padding:2px;text-align:left;letter-spacing:0.05em;transition:color 0.1s;width:100%;}
.choice-btn.on{color:#ffccee;}
.choice-btn.on::before{content:'â–¶ ';}
.choice-btn:not(.on)::before{content:'ã€€';}
.btn-grid{flex:1;display:grid;grid-template-columns:1fr 1fr;grid-template-rows:1fr 1fr;gap:6px;padding:6px 10px 100px;}
.menu-card{border-radius:8px;cursor:pointer;overflow:hidden;position:relative;border:2px solid rgba(255,255,255,0.25);transition:all 0.15s;background:rgba(0,0,0,0.15);}
.menu-card:hover{border-color:rgba(255,180,220,0.7);transform:scale(1.03);box-shadow:0 4px 16px rgba(255,150,200,0.4);}
.menu-card.has-sel{border-color:rgba(255,150,200,0.8);}
.card-bg{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;opacity:0.7;}
.menu-card:hover .card-bg{opacity:0.85;}
.card-label{position:absolute;bottom:0;left:0;right:0;background:rgba(8,6,20,0.75);padding:4px 7px;display:flex;align-items:center;justify-content:space-between;}
.card-name{font-size:clamp(9px,2.2vw,11px);color:#fff;letter-spacing:0.05em;}
.card-price{font-size:clamp(7px,1.8vw,9px);color:#ffaacc;}
.card-check{font-size:9px;color:#ff9ec8;}
.sel-badge{position:absolute;top:4px;right:5px;background:rgba(255,100,180,0.9);color:white;font-size:8px;border-radius:3px;padding:1px 4px;letter-spacing:0.05em;display:none;}
.menu-card.has-sel .sel-badge{display:block;}
.sub{position:absolute;inset:0;background:rgba(8,6,20,0.97);display:none;flex-direction:column;overflow:hidden;}
.sub.show{display:flex;animation:fi 0.2s ease;}
.sub-hdr{display:flex;align-items:center;padding:10px 12px;border-bottom:1px solid rgba(200,160,255,0.2);gap:7px;flex-shrink:0;background:rgba(8,6,20,0.95);position:sticky;top:0;z-index:10;}
.sub-ttl{font-size:clamp(11px,2.8vw,14px);color:#e0c0ff;letter-spacing:0.1em;}
.back{margin-left:auto;background:rgba(200,160,255,0.15);border:1px solid rgba(200,160,255,0.4);border-radius:4px;color:#e0c0ff;font-family:'DotGothic16',monospace;font-size:clamp(9px,2.2vw,10px);padding:4px 10px;cursor:pointer;}
.back:hover{background:rgba(200,160,255,0.3);}
.sub-content{flex:1;overflow-y:auto;padding:12px;}
.player-indicator{font-size:13px;color:#ffccee;margin-bottom:12px;text-align:center;padding:10px;background:rgba(255,150,200,0.25);border:2px solid rgba(255,150,200,0.6);border-radius:6px;font-weight:700;position:sticky;top:0;z-index:5;}
.opt-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:7px;margin-bottom:12px;}
.opt-grid.col3{grid-template-columns:repeat(3,1fr);gap:6px;}
.opt-btn{background:rgba(255,255,255,0.07);border:1.5px solid rgba(255,255,255,0.15);border-radius:7px;padding:10px 6px;cursor:pointer;text-align:center;transition:all 0.15s;display:flex;flex-direction:column;align-items:center;gap:4px;position:relative;}
.opt-btn:hover{background:rgba(255,180,220,0.18);border-color:rgba(255,150,200,0.5);}
.opt-btn.on{background:rgba(255,130,190,0.28);border-color:#ff9ec8;box-shadow:0 0 8px rgba(255,150,200,0.4);}
.opt-btn.on::after{content:'âœ“';position:absolute;top:4px;right:6px;font-size:10px;color:#ff9ec8;}
.opt-e{font-size:clamp(16px,4vw,22px);line-height:1;}
.opt-l{font-family:'DotGothic16',monospace;font-size:clamp(9px,2.2vw,11px);color:#fff;line-height:1.3;}
.opt-p{font-size:clamp(7px,1.8vw,9px);color:#ffaacc;}
.section-title{font-size:12px;color:#e0c0ff;margin:12px 0 8px;padding-bottom:5px;border-bottom:1px solid rgba(200,160,255,0.15);letter-spacing:0.1em;}
.decide-btn{margin-top:12px;flex-shrink:0;background:linear-gradient(135deg,#9060d0,#d060a0);border:none;border-radius:7px;color:white;font-family:'DotGothic16',monospace;font-size:clamp(11px,2.8vw,13px);padding:11px;cursor:pointer;letter-spacing:0.1em;box-shadow:0 4px 12px rgba(192,96,160,0.4);transition:all 0.2s;}
.decide-btn:hover{transform:translateY(-2px);box-shadow:0 6px 16px rgba(192,96,160,0.6);}
.pet-list{margin-bottom:10px;}
.pet-item{margin-bottom:10px;padding:10px;background:rgba(255,255,255,0.05);border:1.5px solid rgba(200,160,255,0.2);border-radius:6px;}
.pet-label{font-size:10px;color:#e0c0ff;margin-bottom:4px;display:block;}
.pet-input{width:100%;border:2px solid rgba(200,160,255,0.35);border-radius:6px;padding:8px 11px;font-family:'DotGothic16',monospace;font-size:12px;color:#fff;background:rgba(255,255,255,0.06);}
.pet-input:focus{outline:none;border-color:#ff9ec8;background:rgba(255,255,255,0.1);}
.add-pet-btn{width:100%;padding:8px;background:rgba(200,160,255,0.15);border:1.5px dashed rgba(200,160,255,0.5);border-radius:6px;color:#e0c0ff;font-family:'DotGothic16',monospace;font-size:11px;cursor:pointer;transition:all 0.2s;}
.add-pet-btn:hover{background:rgba(200,160,255,0.25);border-color:rgba(200,160,255,0.8);}
.free-area{background:rgba(8,6,20,0.92);border-top:2px solid rgba(200,160,255,0.3);padding:9px 11px;display:none;flex-direction:column;gap:7px;}
.free-area.show{display:flex;}
.free-ttl{font-size:11px;color:#e0c0ff;letter-spacing:0.1em;}
.free-input{width:100%;border:1.5px solid rgba(200,160,255,0.3);border-radius:6px;padding:7px 9px;font-family:'DotGothic16',monospace;font-size:11px;color:#fff;background:rgba(255,255,255,0.05);resize:vertical;min-height:65px;line-height:1.5;}
.free-input:focus{outline:none;border-color:#ff9ec8;background:rgba(255,255,255,0.08);}
.free-input::placeholder{color:#888;}
.free-close{background:transparent;border:1px solid rgba(200,160,255,0.3);border-radius:4px;color:#e0c0ff;font-family:'DotGothic16',monospace;font-size:9px;padding:4px 11px;cursor:pointer;align-self:flex-end;}
#result{position:absolute;inset:0;background:rgba(8,6,20,0.98);display:none;flex-direction:column;padding:13px;overflow-y:auto;}
#result.show{display:flex;animation:fi 0.3s ease;}
.res-ttl{font-size:clamp(12px,3.2vw,15px);color:#e0c0ff;text-align:center;margin-bottom:3px;letter-spacing:0.15em;}
.res-sub{font-size:clamp(8px,2.2vw,10px);color:#9070aa;text-align:center;margin-bottom:11px;}
.res-items{background:rgba(255,255,255,0.05);border:1px solid rgba(200,160,255,0.2);border-radius:7px;padding:9px;margin-bottom:9px;flex:1;}
.res-row{display:flex;align-items:flex-start;gap:7px;padding:6px 0;border-bottom:1px solid rgba(255,255,255,0.07);}
.res-row:last-child{border-bottom:none;}
.res-icon{font-size:14px;flex-shrink:0;width:18px;text-align:center;margin-top:1px;}
.res-label{font-size:clamp(7px,1.8vw,9px);color:#9070aa;display:block;margin-bottom:2px;}
.res-val{font-size:clamp(9px,2.3vw,11px);color:#fff;line-height:1.4;}
.edit-btn{background:rgba(200,160,255,0.2);border:1px solid rgba(200,160,255,0.5);border-radius:4px;color:#e0c0ff;font-family:'DotGothic16',monospace;font-size:9px;padding:3px 7px;cursor:pointer;margin-left:auto;flex-shrink:0;transition:all 0.15s;}
.edit-btn:hover{background:rgba(200,160,255,0.35);}
.ss-hint{background:rgba(255,130,190,0.12);border:1.5px dashed rgba(255,130,190,0.5);border-radius:7px;padding:10px;text-align:center;margin-bottom:8px;animation:pulse 2s ease infinite;}
@keyframes pulse{0%,100%{border-color:rgba(255,130,190,0.5);}50%{border-color:rgba(255,130,190,1);box-shadow:0 0 10px rgba(255,130,190,0.25);}}
.ss-icon{font-size:26px;margin-bottom:3px;animation:bou 0.7s ease infinite alternate;}
@keyframes bou{from{transform:translateY(0);}to{transform:translateY(-5px);}}
.ss-text{font-size:clamp(9px,2.3vw,11px);color:#ffddee;line-height:1.5;}
.restart{width:100%;padding:9px;background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.2);border-radius:7px;color:#ccc;font-family:'DotGothic16',monospace;font-size:clamp(9px,2.3vw,11px);cursor:pointer;letter-spacing:0.05em;transition:all 0.2s;}
.restart:hover{background:rgba(255,255,255,0.15);color:#fff;}
</style>
</head>
<body>
<div class="game-wrap">
<div class="bg"></div><div class="bg-overlay"></div>

<div class="screen show" id="scr-lang">
  <div class="scr-title">è¨€èªã‚’é¸ã‚“ã§ã­ï¼</div>
  <div class="scr-sub">Please select your language</div>
  <div class="lang-grid">
    <div class="lang-btn" onclick="selectLang('ja')"><span class="lang-flag">ğŸ‡¯ğŸ‡µ</span><span class="lang-name">æ—¥æœ¬èª</span></div>
    <div class="lang-btn" onclick="selectLang('en')"><span class="lang-flag">ğŸ‡¬ğŸ‡§</span><span class="lang-name">English</span></div>
  </div>
</div>

<div class="screen" id="scr-num">
  <div class="scr-title" id="num-title"></div>
  <div class="scr-sub" id="num-sub"></div>
  <div class="num-grid" id="num-grid"></div>
  <button class="next-btn" id="num-next" disabled onclick="goToNames()"></button>
</div>

<div class="screen" id="scr-names">
  <div class="scr-title" id="name-title"></div>
  <div class="scr-sub" id="name-sub"></div>
  <div class="name-list" id="name-list"></div>
  <div class="checkbox-big" onclick="toggleCheck()">
    <input type="checkbox" id="need-translate" onclick="event.stopPropagation()">
    <label for="need-translate" onclick="event.preventDefault()" id="translate-check"></label>
  </div>
  <button class="next-btn" style="margin-top:14px" onclick="goToMain()" id="name-next"></button>
</div>

<div id="main">
  <div class="char-area">
    <img class="kasumin-img" src="https://raw.githubusercontent.com/kasumin0114/kasumin-assets/main/kasumin.png" alt="Kasumin">
    <div class="dialog">
      <div class="dialog-name">âœ¦ Kasumin âœ¦</div>
      <div class="dialog-text" id="dtxt"></div>
      <div class="choice-wrap" id="choices">
        <button class="choice-btn on" onclick="beginOrder()" id="choice-yes"></button>
        <button class="choice-btn" onclick="noReq()" id="choice-no"></button>
      </div>
    </div>
  </div>

  <div class="btn-grid">
    <div class="menu-card" id="card-bg" onclick="openSub('bg')">
      <div class="card-label"><span class="card-name" id="bg-card-name"></span><span class="card-check" id="chk-bg"></span></div>
      <div class="sel-badge" id="badge-bg-sel"></div>
    </div>
    <div class="menu-card" id="card-costume" onclick="openCostume()">
      <div class="card-label"><span class="card-name" id="costume-card-name"></span><span class="card-price">+Â¥500</span><span class="card-check" id="chk-costume"></span></div>
      <div class="sel-badge" id="badge-costume-sel"></div>
    </div>
    <div class="menu-card" id="card-pet" onclick="openSub('pet')">
      <img class="card-bg" src="https://raw.githubusercontent.com/kasumin0114/kasumin-assets/main/pet.png" alt="pet">
      <div class="card-label"><span class="card-name" id="pet-card-name"></span><span class="card-price">1P price</span><span class="card-check" id="chk-pet"></span></div>
      <div class="sel-badge" id="badge-pet-sel"></div>
    </div>
    <div class="menu-card" id="card-mood" onclick="openMood()">
      <div class="card-label"><span class="card-name" id="mood-card-name"></span><span class="card-check" id="chk-mood"></span></div>
      <div class="sel-badge" id="badge-mood-sel"></div>
    </div>
  </div>

  <div class="free-area" id="free-area">
    <div class="free-ttl" id="free-title"></div>
    <textarea class="free-input" id="free-input"></textarea>
    <button class="free-close" onclick="toggleFree()" id="free-close-btn"></button>
  </div>
</div>

<div class="sub" id="sub-bg">
  <div class="sub-hdr"><span class="sub-ttl" id="bg-title"></span><button class="back" onclick="closeSub('bg')" id="bg-back"></button></div>
  <div class="sub-content">
    <div class="opt-grid" id="bg-grid"></div>
    <button class="decide-btn" onclick="closeSub('bg')" id="bg-decide"></button>
  </div>
</div>

<div class="sub" id="sub-costume">
  <div class="sub-hdr"><span class="sub-ttl" id="costume-title"></span><button class="back" onclick="backCostume()" id="costume-back"></button></div>
  <div class="sub-content">
    <div class="player-indicator" id="costume-player"></div>
    <div class="section-title" id="section-costume-title"></div>
    <div class="opt-grid" id="costume-grid"></div>
    <div class="section-title" id="section-item-title"></div>
    <div class="opt-grid col3" id="item-grid"></div>
    <button class="decide-btn" onclick="nextCostume()" id="costume-decide"></button>
  </div>
</div>

<div class="sub" id="sub-mood">
  <div class="sub-hdr"><span class="sub-ttl" id="mood-title"></span><button class="back" onclick="backMood()" id="mood-back"></button></div>
  <div class="sub-content">
    <div class="player-indicator" id="mood-player"></div>
    <div class="opt-grid col3" id="mood-grid"></div>
    <button class="decide-btn" onclick="nextMood()" id="mood-decide"></button>
  </div>
</div>

<div class="sub" id="sub-pet">
  <div class="sub-hdr"><span class="sub-ttl" id="pet-title"></span><button class="back" onclick="closeSub('pet')" id="pet-back"></button></div>
  <div class="sub-content">
    <div class="scr-sub" style="margin-bottom:12px" id="pet-sub"></div>
    <div class="pet-list" id="pet-list">
      <div class="pet-item">
        <label class="pet-label" id="pet-label-1"></label>
        <input type="text" class="pet-input" id="pet-input-1">
      </div>
    </div>
    <button class="add-pet-btn" onclick="addPet()" id="add-pet-btn"></button>
    <button class="decide-btn" onclick="closeSub('pet')" id="pet-decide"></button>
  </div>
</div>

<div id="result">
  <div class="res-ttl" id="result-title"></div>
  <div class="res-sub" id="result-sub"></div>
  <div class="res-items" id="res-items"></div>
  <div class="ss-hint">
    <div class="ss-icon">ğŸ“¸</div>
    <div class="ss-text" id="ss-text"></div>
  </div>
  <button class="restart" onclick="doRestart()" id="restart-btn"></button>
</div>

</div>

<script>
const BG={sakura:{ja:'æ¡œ',en:'Sakura',e:'ğŸŒ¸'},bluesky:{ja:'é’ç©º',en:'Blue Sky',e:'ğŸŒ¤ï¸'},fireworks:{ja:'èŠ±ç«',en:'Fireworks',e:'ğŸ†'},autumn:{ja:'ç´…è‘‰',en:'Autumn Leaves',e:'ğŸ‚'},fire:{ja:'ç«',en:'Fire',e:'ğŸ”¥'},thunder:{ja:'é›·',en:'Thunder',e:'âš¡'},flowers:{ja:'å­£ç¯€ã®èŠ±',en:'Seasonal Flowers',e:'ğŸŒº'},ocean:{ja:'æµ·',en:'Ocean',e:'ğŸŒŠ'},complex:{ja:'è¤‡é›‘ãªèƒŒæ™¯',en:'Complex BG',e:'ğŸ¨',p:'+Â¥500'}};
const COS={none:{ja:'ãªã—',en:'None',e:'âœ¨'},kimono:{ja:'ç€ç‰©',en:'Kimono',e:'ğŸ‘˜'},ninja:{ja:'å¿è€…',en:'Ninja',e:'ğŸ¥·'},catear:{ja:'ã‚­ãƒ£ãƒƒãƒˆã‚¤ãƒ¤ãƒ¼',en:'Cat Ears',e:'ğŸ±'},uniform:{ja:'åˆ¶æœ',en:'Uniform',e:'ğŸ“'},other:{ja:'ãã®ä»–',en:'Other',e:'ğŸ“'},artist:{ja:'ä½œå®¶ã«ãŠä»»ã›',en:"Artist's Choice",e:'ğŸ²'}};
const ITM={none:{ja:'ãªã—',en:'None',e:'âœ¨'},sword:{ja:'åˆ€',en:'Sword',e:'ğŸ—¡ï¸'},kunai:{ja:'ããªã„',en:'Kunai',e:'ğŸ”ª'},shuriken:{ja:'æ‰‹è£å‰£',en:'Shuriken',e:'â­'},fire:{ja:'ãƒ•ã‚¡ã‚¤ãƒ¤ãƒ¼',en:'Fire',e:'ğŸ”¥'},thunder:{ja:'ã‚µãƒ³ãƒ€ãƒ¼',en:'Thunder',e:'âš¡'},flower:{ja:'èŠ±',en:'Flower',e:'ğŸŒ¸'},star:{ja:'æ˜Ÿ',en:'Star',e:'âœ¨'},book:{ja:'æœ¬',en:'Book',e:'ğŸ“–'},wand:{ja:'é­”æ³•ã®æ–',en:'Magic Wand',e:'ğŸª„'},other:{ja:'ãã®ä»–',en:'Other',e:'ğŸ’«'}};
const MOOD={default:{ja:'ãŠã¾ã‹ã›',en:'Default',e:'ğŸ²'},cute:{ja:'ã‚­ãƒ¥ãƒ¼ãƒˆ',en:'Cute',e:'ğŸŒ¸'},beauty:{ja:'ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚£',en:'Beauty',e:'ğŸ’„'},cool:{ja:'ã‚¯ãƒ¼ãƒ«',en:'Cool',e:'âš¡'},handsome:{ja:'ãƒãƒ³ã‚µãƒ ',en:'Handsome',e:'âœ¨'},serious:{ja:'ã‚·ãƒªã‚¢ã‚¹',en:'Serious',e:'ğŸ—¡ï¸'},cheerful:{ja:'ãƒã‚¢ãƒ•ãƒ«',en:'Cheerful',e:'ğŸŒˆ'},mischief:{ja:'ã„ã˜ã‚ã‚‹',en:'Mischievous',e:'ğŸ˜ˆ'}};
const T={ja:{num_title:'äººæ•°ã‚’é¸ã‚“ã§ã­ï¼',num_sub:'âš ï¸ äºˆç´„æ™‚ã®äººæ•°ã‹ã‚‰å¤‰æ›´ã¯ã§ãã¾ã›ã‚“',num_people:['1äºº','2äºº','3äºº','4äºº'],name_title:'ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®åå‰ã‚’å…¥ã‚Œã¦ã­ï¼',name_sub:'ï¼ˆä¼¼é¡”çµµã«è¨˜å…¥ã™ã‚‹åå‰ã«ãªã‚Šã¾ã™ï¼‰',name_label:'ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼',name_placeholder:'åå‰ã‚’å…¥åŠ›',translate_check:'â˜‘ï¸ æ—¥æœ¬èªã«å¤‰æ›ã—ã¦ã‚‚ã‚‰ã†',next_btn:'æ¬¡ã¸ â†’',kasumin_q:'ä½•ã‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã”ã–ã„ã¾ã™ã‹ï¼Ÿ',choice_yes:'Yes',choice_no:'No',no_request:'ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒãªãã¦ã‚‚å¤§ä¸ˆå¤«ï¼ä½œå®¶ã«ãŠä»»ã›âœ¨',select_category:'ã‚«ãƒ†ã‚´ãƒªã‚’é¸ã‚“ã§ã­ï¼',bg_card:'Background',costume_card:'Costume',pet_card:'Pet',mood_card:'Mood',bg_title:'ğŸ—ºï¸ Background',costume_title:'ğŸ‘— Costume & Item',mood_title:'âœ¨ Mood',pet_title:'ğŸ¾ Pet',back_btn:'â† Back',decide_btn:'æ±ºå®š âœ“',section_costume:'Costume',section_item:'Item',pet_sub:'ãƒšãƒƒãƒˆã®åå‰ã‚’å…¥ã‚Œã¦ã­<br>å‚è€ƒç”»åƒã‚’è¤‡æ•°æšæŒã£ã¦ãã¦ã­ï¼',pet_label:'ãƒšãƒƒãƒˆ',pet_placeholder:'ä¾‹ï¼šãƒãƒã€Tama',add_pet_btn:'+ ãƒšãƒƒãƒˆã‚’è¿½åŠ ',free_title:'ğŸ’Œ ãã®ä»–ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆè‡ªç”±è¨˜å…¥ï¼‰',free_placeholder:'ä¸Šè¨˜ã«å½“ã¦ã¯ã¾ã‚‰ãªã„å½¢å¼ã§ã‚‚å¤§ä¸ˆå¤«ã§ã™ï¼ãªã‚“ã§ã‚‚æ›¸ã„ã¦ã­',free_close:'âœ“ é–‰ã˜ã‚‹',result_title:'âœ¦ Order Complete! âœ¦',result_sub:'KasuminãŒã‚ãªãŸã®ä¼¼é¡”çµµã‚’æãã¾ã™ğŸ¨',ss_text:'ã“ã®ãƒšãƒ¼ã‚¸ã‚’ã‚¹ã‚¯ã‚·ãƒ§ã—ã¦<br>ä½œå®¶ã•ã‚“ã«é€ã£ã¦ã­ğŸ€',restart_btn:'ğŸ”„ æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™',edit_btn:'âœï¸ ç·¨é›†',num_people_label:'äººæ•°',names_label:'åå‰',translate_label:'ç¿»è¨³',translate_yes:'æ—¥æœ¬èªã«å¤‰æ›å¸Œæœ›',bg_label:'Background',costume_label:'Costume&Item',mood_label:'Mood',pet_label_result:'Pet',other_label:'ãã®ä»–',none:'ãªã—',default:'ãŠã¾ã‹ã›',player_costume:'ã®ã‚³ã‚¹ãƒãƒ¥ãƒ¼ãƒ ãƒ»ã‚¢ã‚¤ãƒ†ãƒ ',player_mood:'ã®ãƒ ãƒ¼ãƒ‰',select_costume:'ã®ã‚³ã‚¹ãƒãƒ¥ãƒ¼ãƒ ã‚’é¸ã‚“ã§ã­ğŸ‘—',select_mood:'ã®ãƒ ãƒ¼ãƒ‰ã‚’é¸ã‚“ã§ã­âœ¨',select_bg:'èƒŒæ™¯ã‚’é¸ã‚“ã§ã­ğŸ—ºï¸',select_pet:'ãƒšãƒƒãƒˆã®æƒ…å ±ã‚’å…¥ã‚Œã¦ã­ğŸ¾',select_free:'è‡ªç”±ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ›¸ã„ã¦ã­ğŸ’Œ',selected:'é¸æŠæ¸ˆã¿',people_suffix:'äºº'},en:{num_title:'Select Number of People',num_sub:'âš ï¸ Cannot be changed after booking',num_people:['1 Person','2 People','3 People','4 People'],name_title:'Enter Player Names',name_sub:'(Names to be written on the portrait)',name_label:'Player',name_placeholder:'Enter name',translate_check:'â˜‘ï¸ Translate to Japanese',next_btn:'Next â†’',kasumin_q:'Do you have any request?',choice_yes:'Yes',choice_no:'No',no_request:'No requests needed! Leave it to the artistâœ¨',select_category:'Select a category!',bg_card:'Background',costume_card:'Costume',pet_card:'Pet',mood_card:'Mood',bg_title:'ğŸ—ºï¸ Background',costume_title:'ğŸ‘— Costume & Item',mood_title:'âœ¨ Mood',pet_title:'ğŸ¾ Pet',back_btn:'â† Back',decide_btn:'Confirm âœ“',section_costume:'Costume',section_item:'Item',pet_sub:'Enter pet name<br>Please bring reference images!',pet_label:'Pet',pet_placeholder:'e.g., Pochi, Tama',add_pet_btn:'+ Add Pet',free_title:'ğŸ’Œ Other Requests (Free Text)',free_placeholder:'Any other requests are welcome!',free_close:'âœ“ Close',result_title:'âœ¦ Order Complete! âœ¦',result_sub:'Kasumin will draw your portraitğŸ¨',ss_text:'Take a screenshot and send it<br>to the artistğŸ€',restart_btn:'ğŸ”„ Start Over',edit_btn:'âœï¸ Edit',num_people_label:'Number of People',names_label:'Names',translate_label:'Translation',translate_yes:'Translate to Japanese',bg_label:'Background',costume_label:'Costume & Item',mood_label:'Mood',pet_label_result:'Pet',other_label:'Other Requests',none:'None',default:'Default',player_costume:"'s Costume & Item",player_mood:"'s Mood",select_costume:"'s costumeğŸ‘—",select_mood:"'s moodâœ¨",select_bg:'Select backgroundğŸ—ºï¸',select_pet:'Enter pet infoğŸ¾',select_free:'Write your requestsğŸ’Œ',selected:'Selected',people_suffix:' people'}};

const S={lang:'ja',numPlayers:0,names:[],needTranslate:false,bg:'',costume:[],item:[],pets:[],mood:[],free:''};
let currentPlayer=0,petCount=1,editingMode=false;

function selectLang(l){S.lang=l;document.getElementById('scr-lang').classList.remove('show');document.getElementById('scr-num').classList.add('show');renderNumScreen();}
function renderNumScreen(){const t=T[S.lang];document.getElementById('num-title').textContent=t.num_title;document.getElementById('num-sub').textContent=t.num_sub;const g=document.getElementById('num-grid');g.innerHTML='';for(let i=0;i<4;i++){const n=i+1;g.innerHTML+=`<div class="num-btn" onclick="selectNum(${n})"><span class="num-emoji">${'ğŸ™‹'.repeat(n)}</span><span class="num-label">${t.num_people[i]}</span><span class="num-price">Â¥${[3000,5000,6000,7000][i].toLocaleString()}</span></div>`;}document.getElementById('num-next').textContent=t.next_btn;}
function toggleCheck(){const cb=document.getElementById('need-translate');cb.checked=!cb.checked;}
function selectNum(n){S.numPlayers=n;document.querySelectorAll('.num-btn').forEach(b=>b.classList.remove('on'));event.target.closest('.num-btn').classList.add('on');document.getElementById('num-next').disabled=false;}
function goToNames(){document.getElementById('scr-num').classList.remove('show');document.getElementById('scr-names').classList.add('show');const t=T[S.lang];document.getElementById('name-title').textContent=t.name_title;document.getElementById('name-sub').textContent=t.name_sub;document.getElementById('translate-check').textContent=t.translate_check;document.getElementById('name-next').textContent=t.next_btn;const list=document.getElementById('name-list');list.innerHTML='';for(let i=0;i<S.numPlayers;i++){list.innerHTML+=`<div class="name-item"><label class="name-label">${t.name_label}${i+1}</label><input type="text" class="name-input" id="name-${i}" placeholder="${t.name_placeholder}"></div>`;}}
function goToMain(){S.names=[];for(let i=0;i<S.numPlayers;i++)S.names.push(document.getElementById('name-'+i).value||'Player '+(i+1));S.needTranslate=document.getElementById('need-translate').checked;if(!editingMode){S.costume=Array(S.numPlayers).fill(null).map(()=>[]);S.item=Array(S.numPlayers).fill(null).map(()=>[]);S.mood=Array(S.numPlayers).fill(null).map(()=>[]);}document.getElementById('scr-names').classList.remove('show');if(editingMode){editingMode=false;showResult();}else{renderMainScreen();document.getElementById('main').classList.add('show');}}
function renderMainScreen(){const t=T[S.lang];document.getElementById('dtxt').innerHTML=t.kasumin_q+'<span class="blink">â–®</span>';document.getElementById('choice-yes').textContent=t.choice_yes;document.getElementById('choice-no').textContent=t.choice_no;document.getElementById('bg-card-name').textContent=t.bg_card;document.getElementById('costume-card-name').textContent=t.costume_card;document.getElementById('pet-card-name').textContent=t.pet_card;document.getElementById('mood-card-name').textContent=t.mood_card;document.getElementById('badge-bg-sel').textContent=t.selected;document.getElementById('badge-costume-sel').textContent=t.selected;document.getElementById('badge-pet-sel').textContent=t.selected;document.getElementById('badge-mood-sel').textContent=t.selected;document.getElementById('free-title').textContent=t.free_title;document.getElementById('free-input').placeholder=t.free_placeholder;document.getElementById('free-close-btn').textContent=t.free_close;}
function setDialog(k){const t=T[S.lang];document.getElementById('dtxt').innerHTML=t[k]+'<span class="blink">â–®</span>';}
function beginOrder(){document.getElementById('choices').style.display='none';setDialog('select_category');}
function noReq(){setDialog('no_request');}
function openSub(type){document.querySelectorAll('.sub').forEach(s=>s.classList.remove('show'));document.getElementById('free-area').classList.remove('show');document.getElementById('sub-'+type).classList.add('show');const t=T[S.lang];if(type==='bg'){document.getElementById('bg-title').textContent=t.bg_title;document.getElementById('bg-back').textContent=t.back_btn;document.getElementById('bg-decide').textContent=t.decide_btn;const g=document.getElementById('bg-grid');g.innerHTML=Object.keys(BG).map(k=>{const b=BG[k];const on=S.bg===k?'on':'';const price=b.p?`<span class="opt-p">${b.p}</span>`:'';return`<button class="opt-btn ${on}" onclick="pickBg(this,'${k}')"><span class="opt-e">${b.e}</span><span class="opt-l">${b[S.lang]}</span>${price}</button>`;}).join('');setDialog('select_bg');}else if(type==='pet'){document.getElementById('pet-title').textContent=t.pet_title;document.getElementById('pet-back').textContent=t.back_btn;document.getElementById('pet-sub').innerHTML=t.pet_sub;document.getElementById('add-pet-btn').textContent=t.add_pet_btn;document.getElementById('pet-decide').textContent=t.decide_btn;document.getElementById('pet-label-1').textContent=t.pet_label+'1ã®åå‰';document.getElementById('pet-input-1').placeholder=t.pet_placeholder;setDialog('select_pet');}}
function closeSub(type){document.getElementById('sub-'+type).classList.remove('show');if(editingMode){editingMode=false;showResult();}else{setDialog('select_category');updateBadge(type);checkShowBtn();}}
function pickBg(btn,k){document.querySelectorAll('#bg-grid .opt-btn').forEach(b=>b.classList.remove('on'));btn.classList.add('on');S.bg=k;}
function openCostume(){currentPlayer=0;showCostumeForPlayer(0);document.getElementById('sub-costume').classList.add('show');document.getElementById('free-area').classList.remove('show');}
function showCostumeForPlayer(p){const t=T[S.lang];document.getElementById('costume-title').textContent=t.costume_title;document.getElementById('costume-back').textContent=t.back_btn;document.getElementById('section-costume-title').textContent=t.section_costume;document.getElementById('section-item-title').textContent=t.section_item;document.getElementById('costume-decide').textContent=t.decide_btn;document.getElementById('costume-player').textContent=t.name_label+(p+1)+'ï¼ˆ'+S.names[p]+'ï¼‰'+t.player_costume;const msg=S.names[p]+t.select_costume;document.getElementById('dtxt').innerHTML=msg+'<span class="blink">â–®</span>';const cg=document.getElementById('costume-grid');const ig=document.getElementById('item-grid');cg.innerHTML=Object.keys(COS).map(k=>{const c=COS[k];const on=S.costume[p].includes(k)?'on':'';return`<button class="opt-btn ${on}" onclick="pickCostume(${p},'${k}',this)"><span class="opt-e">${c.e}</span><span class="opt-l">${c[S.lang]}</span></button>`;}).join('');ig.innerHTML=Object.keys(ITM).map(k=>{const i=ITM[k];const on=S.item[p].includes(k)?'on':'';return`<button class="opt-btn ${on}" onclick="pickItem(${p},'${k}',this)"><span class="opt-e">${i.e}</span><span class="opt-l">${i[S.lang]}</span></button>`;}).join('');}
function pickCostume(p,k,btn){btn.classList.toggle('on');if(btn.classList.contains('on')){if(!S.costume[p].includes(k))S.costume[p].push(k);}else S.costume[p]=S.costume[p].filter(x=>x!==k);}
function pickItem(p,k,btn){btn.classList.toggle('on');if(btn.classList.contains('on')){if(!S.item[p].includes(k))S.item[p].push(k);}else S.item[p]=S.item[p].filter(x=>x!==k);}
function nextCostume(){if(editingMode){editingMode=false;document.getElementById('sub-costume').classList.remove('show');showResult();}else{currentPlayer++;if(currentPlayer<S.numPlayers)showCostumeForPlayer(currentPlayer);else{document.getElementById('sub-costume').classList.remove('show');setDialog('select_category');updateBadge('costume');checkShowBtn();}}}
function backCostume(){if(currentPlayer>0){currentPlayer--;showCostumeForPlayer(currentPlayer);}else{document.getElementById('sub-costume').classList.remove('show');setDialog('select_category');}}
function openMood(){currentPlayer=0;showMoodForPlayer(0);document.getElementById('sub-mood').classList.add('show');document.getElementById('free-area').classList.remove('show');}
function showMoodForPlayer(p){const t=T[S.lang];document.getElementById('mood-title').textContent=t.mood_title;document.getElementById('mood-back').textContent=t.back_btn;document.getElementById('mood-decide').textContent=t.decide_btn;document.getElementById('mood-player').textContent=t.name_label+(p+1)+'ï¼ˆ'+S.names[p]+'ï¼‰'+t.player_mood;const msg=S.names[p]+t.select_mood;document.getElementById('dtxt').innerHTML=msg+'<span class="blink">â–®</span>';const mg=document.getElementById('mood-grid');mg.innerHTML=Object.keys(MOOD).map(k=>{const m=MOOD[k];const on=S.mood[p].includes(k)?'on':'';return`<button class="opt-btn ${on}" onclick="pickMood(${p},'${k}',this)"><span class="opt-e">${m.e}</span><span class="opt-l">${m[S.lang]}</span></button>`;}).join('');}
function pickMood(p,k,btn){btn.classList.toggle('on');if(btn.classList.contains('on')){if(!S.mood[p].includes(k))S.mood[p].push(k);}else S.mood[p]=S.mood[p].filter(x=>x!==k);}
function nextMood(){if(editingMode){editingMode=false;document.getElementById('sub-mood').classList.remove('show');showResult();}else{currentPlayer++;if(currentPlayer<S.numPlayers)showMoodForPlayer(currentPlayer);else{document.getElementById('sub-mood').classList.remove('show');setDialog('select_category');updateBadge('mood');checkShowBtn();}}}
function backMood(){if(currentPlayer>0){currentPlayer--;showMoodForPlayer(currentPlayer);}else{document.getElementById('sub-mood').classList.remove('show');setDialog('select_category');}}
function addPet(){petCount++;const t=T[S.lang];const item=document.createElement('div');item.className='pet-item';item.innerHTML=`<label class="pet-label">${t.pet_label}${petCount}ã®åå‰</label><input type="text" class="pet-input" placeholder="${t.pet_placeholder}">`;document.getElementById('pet-list').appendChild(item);}
function updateBadge(type){let has=false;if(type==='costume')has=S.costume.some(a=>a.length>0)||S.item.some(a=>a.length>0);else if(type==='mood')has=S.mood.some(a=>a.length>0);else if(type==='pet'){const inputs=document.querySelectorAll('#pet-list .pet-input');has=Array.from(inputs).some(inp=>inp.value.trim()!=='');}else if(type==='bg')has=S.bg!=='';document.getElementById('card-'+type).classList.toggle('has-sel',has);document.getElementById('chk-'+type).textContent=has?'âœ“':'';}
function toggleFree(){const fa=document.getElementById('free-area');fa.classList.toggle('show');if(editingMode && !fa.classList.contains('show')){editingMode=false;document.getElementById('main').classList.remove('show');showResult();}else if(fa.classList.contains('show')){setDialog('select_free');}else{setDialog('select_category');checkShowBtn();}}
function checkShowBtn(){const hasPets=Array.from(document.querySelectorAll('#pet-list .pet-input')).some(inp=>inp.value.trim()!=='');const any=S.bg||S.costume.some(a=>a.length>0)||S.item.some(a=>a.length>0)||S.mood.some(a=>a.length>0)||hasPets||document.getElementById('free-input').value.trim();let fb=document.getElementById('fin-btn');if(!fb){fb=document.createElement('button');fb.style.cssText='position:absolute;bottom:8px;left:50%;transform:translateX(-50%);z-index:20;background:linear-gradient(135deg,#9060d0,#d060a0);border:none;border-radius:7px;color:white;font-family:"DotGothic16",monospace;font-size:12px;padding:10px 24px;cursor:pointer;box-shadow:0 4px 12px rgba(192,96,160,0.5);letter-spacing:0.1em;white-space:nowrap;';fb.id='fin-btn';fb.onclick=showResult;document.querySelector('.game-wrap').appendChild(fb);}const t=T[S.lang];fb.textContent=S.lang==='ja'?'âœ¦ ã‚ªãƒ¼ãƒ€ãƒ¼ç¢ºå®š âœ¦':'âœ¦ Confirm Order âœ¦';fb.style.display=any?'block':'none';}
function showResult(){S.pets=[];document.querySelectorAll('#pet-list .pet-input').forEach(inp=>{const v=inp.value.trim();if(v)S.pets.push(v);});S.free=document.getElementById('free-input').value;document.getElementById('main').classList.remove('show');document.getElementById('scr-names').classList.remove('show');document.querySelectorAll('.sub').forEach(s=>s.classList.remove('show'));document.getElementById('free-area').classList.remove('show');const fb=document.getElementById('fin-btn');if(fb)fb.style.display='none';const t=T[S.lang];document.getElementById('result-title').textContent=t.result_title;document.getElementById('result-sub').textContent=t.result_sub;document.getElementById('ss-text').innerHTML=t.ss_text;document.getElementById('restart-btn').textContent=t.restart_btn;let html='';html+=`<div class="res-row"><div class="res-icon">ğŸ‘¥</div><div><span class="res-label">${t.num_people_label}</span><span class="res-val">${S.numPlayers}${t.people_suffix}</span></div></div>`;html+=`<div class="res-row"><div class="res-icon">âœï¸</div><div style="flex:1"><span class="res-label">${t.names_label}</span><span class="res-val">${S.names.join('ãƒ»')}</span></div><button class="edit-btn" onclick="editNames()">${t.edit_btn}</button></div>`;if(S.needTranslate)html+=`<div class="res-row"><div class="res-icon">ğŸŒ</div><div><span class="res-label">${t.translate_label}</span><span class="res-val">${t.translate_yes}</span></div></div>`;html+=`<div class="res-row"><div class="res-icon">ğŸ—ºï¸</div><div style="flex:1"><span class="res-label">${t.bg_label}</span><span class="res-val">${S.bg?BG[S.bg][S.lang]:t.none}</span></div><button class="edit-btn" onclick="editBg()">${t.edit_btn}</button></div>`;for(let i=0;i<S.numPlayers;i++){const c=S.costume[i].length||S.item[i].length?[...S.costume[i].map(k=>COS[k][S.lang]),...S.item[i].map(k=>ITM[k][S.lang])].join('ãƒ»'):t.none;html+=`<div class="res-row"><div class="res-icon">ğŸ‘—</div><div style="flex:1"><span class="res-label">${S.names[i]} ${t.costume_label}</span><span class="res-val">${c}</span></div><button class="edit-btn" onclick="editCostume(${i})">${t.edit_btn}</button></div>`;}for(let i=0;i<S.numPlayers;i++){const m=S.mood[i].length?S.mood[i].map(k=>MOOD[k][S.lang]).join('ãƒ»'):t.default;html+=`<div class="res-row"><div class="res-icon">âœ¨</div><div style="flex:1"><span class="res-label">${S.names[i]} ${t.mood_label}</span><span class="res-val">${m}</span></div><button class="edit-btn" onclick="editMood(${i})">${t.edit_btn}</button></div>`;}html+=`<div class="res-row"><div class="res-icon">ğŸ¾</div><div style="flex:1"><span class="res-label">${t.pet_label_result}</span><span class="res-val">${S.pets.length?S.pets.join('ãƒ»'):t.none}</span></div><button class="edit-btn" onclick="editPet()">${t.edit_btn}</button></div>`;html+=`<div class="res-row"><div class="res-icon">ğŸ’Œ</div><div style="flex:1"><span class="res-label">${t.other_label}</span><span class="res-val">${S.free||'ï¼ˆ'+t.none+'ï¼‰'}</span></div><button class="edit-btn" onclick="editFree()">${t.edit_btn}</button></div>`;document.getElementById('res-items').innerHTML=html;document.getElementById('result').classList.add('show');}
function editNames(){editingMode=true;document.getElementById('result').classList.remove('show');document.getElementById('main').classList.remove('show');document.querySelectorAll('.sub').forEach(s=>s.classList.remove('show'));document.getElementById('free-area').classList.remove('show');document.getElementById('scr-names').classList.add('show');const t=T[S.lang];document.getElementById('name-title').textContent=t.name_title;document.getElementById('name-sub').textContent=t.name_sub;document.getElementById('translate-check').textContent=t.translate_check;document.getElementById('name-next').textContent=t.next_btn;const list=document.getElementById('name-list');list.innerHTML='';for(let i=0;i<S.numPlayers;i++){list.innerHTML+=`<div class="name-item"><label class="name-label">${t.name_label}${i+1}</label><input type="text" class="name-input" id="name-${i}" placeholder="${t.name_placeholder}" value="${S.names[i]}"></div>`;}document.getElementById('need-translate').checked=S.needTranslate;}
function editBg(){editingMode=true;document.getElementById('result').classList.remove('show');document.getElementById('main').classList.remove('show');document.getElementById('scr-names').classList.remove('show');document.getElementById('free-area').classList.remove('show');openSub('bg');document.getElementById('sub-bg').classList.add('show');}
function editCostume(p){editingMode=true;currentPlayer=p;document.getElementById('result').classList.remove('show');document.getElementById('main').classList.remove('show');document.getElementById('scr-names').classList.remove('show');document.getElementById('free-area').classList.remove('show');showCostumeForPlayer(p);document.getElementById('sub-costume').classList.add('show');}
function editMood(p){editingMode=true;currentPlayer=p;document.getElementById('result').classList.remove('show');document.getElementById('main').classList.remove('show');document.getElementById('scr-names').classList.remove('show');document.getElementById('free-area').classList.remove('show');showMoodForPlayer(p);document.getElementById('sub-mood').classList.add('show');}
function editPet(){editingMode=true;document.getElementById('result').classList.remove('show');document.getElementById('main').classList.remove('show');document.getElementById('scr-names').classList.remove('show');document.getElementById('free-area').classList.remove('show');const t=T[S.lang];document.getElementById('pet-title').textContent=t.pet_title;document.getElementById('pet-back').textContent=t.back_btn;document.getElementById('pet-sub').innerHTML=t.pet_sub;document.getElementById('add-pet-btn').textContent=t.add_pet_btn;document.getElementById('pet-decide').textContent=t.decide_btn;const list=document.getElementById('pet-list');list.innerHTML='';petCount=0;if(S.pets.length===0){petCount=1;list.innerHTML=`<div class="pet-item"><label class="pet-label">${t.pet_label}1ã®åå‰</label><input type="text" class="pet-input" placeholder="${t.pet_placeholder}"></div>`;}else{S.pets.forEach((name,i)=>{petCount=i+1;const item=document.createElement('div');item.className='pet-item';item.innerHTML=`<label class="pet-label">${t.pet_label}${i+1}ã®åå‰</label><input type="text" class="pet-input" placeholder="${t.pet_placeholder}" value="${name}">`;list.appendChild(item);});}document.getElementById('sub-pet').classList.add('show');}
function editFree(){editingMode=true;document.getElementById('result').classList.remove('show');document.getElementById('scr-names').classList.remove('show');document.querySelectorAll('.sub').forEach(s=>s.classList.remove('show'));renderMainScreen();document.getElementById('main').classList.add('show');document.getElementById('free-area').classList.add('show');}
function doRestart(){location.reload();}
</script>

</body>
</html>
